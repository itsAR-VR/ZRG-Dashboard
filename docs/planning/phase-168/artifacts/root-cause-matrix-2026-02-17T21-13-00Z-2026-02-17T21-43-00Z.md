# Root-Cause Attribution Matrix (Phase 168b)

## Window + Evidence Inputs
- window: `2026-02-17T21:13:00Z` â†’ `2026-02-17T21:43:00Z` (inferred from canonical export timestamp)
- canonical export: `zrg-dashboard-log-export-2026-02-17T21-43-29.json`
- forensics: `docs/planning/phase-168/artifacts/log-forensics-2026-02-17T21-43-29.md`
- reversal-loop slice: `docs/planning/phase-168/artifacts/reversal-loop-confirmation-2026-02-17.md`

## Matrix
| Rank | Failure Class | Baseline Evidence | Owner Paths | Phase 168 Action | Phase 169 Dependency |
|---|---|---|---|---|---|
| 1 | Webhook request-path saturation (`/api/webhooks/email` 60s timeouts) | `/api/webhooks/email` failures `21,050`; `Task timed out after 60 seconds` `5,063`; `timeout_60s` route/signature `4,985` | `app/api/webhooks/email/route.ts` | Production lock `INBOXXIA_EMAIL_SENT_ASYNC=true`; keep request path minimal and queue-first | No new event contract added in 168 (owned by 169 for additional migrations) |
| 2 | Inbox read-path timeout/contention (`/api/inbox/conversations`) | failures `13,656`; `Task timed out after 300 seconds` `3,289`; `timeout_300s` route/signature `3,202`; `P2028` cluster present | `app/api/inbox/conversations/route.ts`, `app/api/inbox/counts/route.ts`, `actions/lead-actions.ts` | Preserve timeout guardrails + diagnostics; validate with live `x-zrg-duration-ms` sampling | None (inline hardening remains in existing route stack) |
| 3 | Response-timing cron failures | `/api/cron/response-timing` `500` = `545`; expired transaction signatures in baseline; live hotfix found `22003 integer out of range` | `app/api/cron/response-timing/route.ts`, `lib/response-timing/processor.ts` | Clamp response-ms writes + deploy hotfix; verify cron endpoint returns success/dispatch | Optional future offload tuning belongs to 169 if further migrations are needed |
| 4 | Cross-route DB wait pressure | `query_wait_timeout` `419` across inbox + cron routes, with overlapping reversal-loop window | `app/api/cron/background-jobs/route.ts`, `lib/inngest/functions/process-background-jobs.ts`, cron route set | Keep background dispatch in Inngest mode and disable inline emergency fallback by default | 169 owns any additional per-route `*_USE_INNGEST` migrations |
| 5 | Secondary reconcile/transport noise | low-frequency unique/race and downstream API noise (`P2010`, `client_login_timeout`, external 502/fetch issues) | reconcile/integration call paths | monitor-only in 168 | defer unless post-fix signatures reappear |

## Decision Outcome for 168c
- Execute only high-impact, low-scope fixes in Phase 168:
  - env rollout for async/offload flags,
  - response-timing overflow hotfix in `lib/response-timing/processor.ts`,
  - no new Inngest route contracts.
- Hold new route migration contracts/flags for Phase 169.

## Residual Risk
- Canonical matched-window dashboard export pair was not available in this one-shot run, so post-fix deltas are validated via live spot-check packet (see 168d artifacts) and marked `partially confirmed`.
